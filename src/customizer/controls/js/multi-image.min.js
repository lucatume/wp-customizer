/*! theAverageDeve libraries - v0.1.0
 * https://github.com/lucatume/tad-libs-for-wordpress
 * Copyright (c) 2014; * Licensed GPLv2+ */

function RemoveAction(a){this.parent=a,this.removeButton=jQuery("<span></span>"),this.removeButton.attr("class","removeIcon"),this.removeButton.append(jQuery("<a>x</a>")),this.removeButton.on("click",function(a){a.preventDefault();var b=jQuery(this).parent(),c=b.closest(".customize-control-multi-image"),d=c.find("input.multi-images-control-input"),e=[];b.remove(),jQuery(c).find(".thumbnail").each(function(){e.push(jQuery(this).data("src"))}),d.val(e.reverse()).trigger("change"),d.trigger("updateThumbnails",{urls:e})}),this.parent.append(this.removeButton)}function MultiImageControl(a){this.root=a,this.store=a.find("input.multi-images-control-input"),this.uploadButtton=a.find(".multi-images-upload"),this.removeButton=a.find(".multi-images-remove"),this.thumbnails=a.find("ul.thumbnails"),this.start=function(){this.uploadButtton.on("click",function(a){var b,c=jQuery(this).closest(".customize-control-multi-image").find("input.multi-images-control-input");return a.preventDefault(),b?void b.open():(b=wp.media.frames.file_frame=wp.media({title:jQuery(this).data("uploader_title"),button:jQuery(this).data("uploader_button_text"),multiple:!0,library:{type:"image"}}),b.on("select",function(){for(var a=b.state().get("selection").toJSON(),d=[],e=a.length-1;e>=0;e--)d.push(a[e].url);c.val(d).trigger("change"),c.trigger("updateThumbnails",{urls:d})}),void b.open())}),this.removeButton.on("click",function(a){var b,c,d,e,f=[];b=jQuery(this).closest(".customize-control-multi-image"),c=b.find(".thumbnails"),d=b.find("input.multi-images-control-input"),a.preventDefault(),e=c.find(".thumbnail.selected"),0===e.length?f="":c.find(".thumbnail:not(.selected)").each(function(){f.push(jQuery(this).data("src"))}),d.val(f).trigger("change"),d.trigger("updateThumbnails",{urls:f})}),this.removeButton.on("updateLabelAndVisibility",function(){var a,b,c,d,e;return a=jQuery(this),b=a.closest(".customize-control-multi-image").find(".thumbnails"),c=b.find(".thumbnail"),0===c.length?void a.hide():(a.show(),d=b.find(".thumbnail.selected"),e=d.length,void(0===e?a.text("Remove all images"):1===e?a.text("Remove the image"):e>=2&&a.text("Remove "+e+" images")))}),this.store.on("updateThumbnails",function(a,b){var c,d,e=b.urls;c=jQuery(this).closest(".customize-control-multi-image"),d=c.find(".thumbnails"),d.empty();for(var f=e.length-1;f>=0;f--){var g=jQuery("<li/>");g.attr("style","background-image:url("+e[f]+");"),g.attr("class","thumbnail"),g.attr("data-src",e[f]),d.append(g)}c.find(".multi-images-remove").trigger("updateLabelAndVisibility")}),this.thumbnails.sortable({items:"> li",axis:"y",opacity:.6,distance:3,cursor:"move",delay:150,tolerance:"pointer",update:function(){var a,b=jQuery(this),c=[];jQuery(b.find("li")).each(function(){var a=jQuery(this);c.push(a.data("src")),a.removeClass("no-list")}),a=b.closest(".customize-control-multi-image").find("input.multi-images-control-input"),a.val(c).trigger("change"),b.sortable("refreshPositions")},start:function(){var a=jQuery(this);a.find("li").each(function(){jQuery(this).addClass("no-list"),jQuery(this).removeClass("selected")}),a.closest(".customize-control-multi-image").find(".multi-images-remove").trigger("updateLabelAndVisibility")}}).disableSelection(),jQuery(".customize-control-multi-image .thumbnails").on("click",".thumbnail",function(){var a=jQuery(this),b=a.closest(".customize-control-multi-image").find(".multi-images-remove").first();a.toggleClass("selected"),a.hasClass("selected")?new RemoveAction(a):a.empty(),b.trigger("updateLabelAndVisibility")}),this.removeButton.trigger("updateLabelAndVisibility")}}jQuery(document).ready(function(a){"use strict";a(".customize-control-multi-image").each(function(){new MultiImageControl(a(this)).start()})});
//# sourceMappingURL=multi-image.min.map